// LearningController.js
// VOICE-SAFE KERNEL
// GUARANTEE:
// - learn() à¤¹à¤®à¥‡à¤¶à¤¾ string à¤²à¥Œà¤Ÿà¤¾à¤à¤—à¤¾
// - à¤•à¥‹à¤ˆ async / storage / reasoning à¤¨à¤¹à¥€à¤‚
// - à¤†à¤µà¤¾à¤œà¤¼ à¤•à¤­à¥€ à¤¬à¤‚à¤¦ à¤¨à¤¹à¥€à¤‚ à¤¹à¥‹à¤—à¥€

export class LearningController {

  learn(input) {

    // ðŸ”’ Absolute String Guard
    if (typeof input !== "string") {
      return "à¤®à¥ˆà¤‚ à¤†à¤ªà¤•à¥€ à¤¬à¤¾à¤¤ à¤¸à¥à¤¨ à¤¨à¤¹à¥€à¤‚ à¤ªà¤¾à¤ˆà¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤«à¤¿à¤° à¤¸à¥‡ à¤•à¤¹à¤¿à¤à¥¤";
    }

    const text = input.trim();

    if (text === "") {
      return "à¤†à¤ª à¤•à¥à¤› à¤•à¤¹à¤¨à¤¾ à¤šà¤¾à¤¹ à¤°à¤¹à¥‡ à¤¹à¥ˆà¤‚à¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤¸à¥à¤ªà¤·à¥à¤Ÿ à¤¬à¥‹à¤²à¤¿à¤à¥¤";
    }

    // =========================
    // BASIC QUESTION DETECTION
    // =========================
    if (this.isQuestion(text)) {
      return this.answerQuestion(text);
    }

    // =========================
    // DEFAULT SAFE RESPONSE
    // =========================
    return "à¤®à¥ˆà¤‚ à¤¸à¥à¤¨ à¤°à¤¹à¥€ à¤¹à¥‚à¤à¥¤ à¤†à¤ª à¤†à¤—à¥‡ à¤¬à¥‹à¤² à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚à¥¤";
  }

  /* =========================
     QUESTION HANDLER
  ========================= */
  answerQuestion(text) {

    // à¤ªà¤¹à¤šà¤¾à¤¨
    if (
      this.includesAny(text, ["à¤¤à¥à¤®", "à¤†à¤ª", "à¤…à¤‚à¤œà¤²à¥€"]) &&
      this.includesAny(text, ["à¤•à¥Œà¤¨", "à¤¨à¤¾à¤®"])
    ) {
      return "à¤®à¥‡à¤°à¤¾ à¤¨à¤¾à¤® à¤…à¤‚à¤œà¤²à¥€ à¤¹à¥ˆà¥¤";
    }

    // à¤•à¥à¤¯à¥‹à¤‚
    if (text.includes("à¤•à¥à¤¯à¥‹à¤‚")) {
      return "à¤•à¥à¤¯à¥‹à¤‚ à¤•à¤¾ à¤‰à¤¤à¥à¤¤à¤° à¤•à¤¾à¤°à¤£ à¤®à¥‡à¤‚ à¤›à¤¿à¤ªà¤¾ à¤¹à¥‹à¤¤à¤¾ à¤¹à¥ˆà¥¤ à¤†à¤ª à¤µà¤¿à¤·à¤¯ à¤¸à¥à¤ªà¤·à¥à¤Ÿ à¤•à¤°à¥‡à¤‚à¥¤";
    }

    // à¤•à¥ˆà¤¸à¥‡
    if (text.includes("à¤•à¥ˆà¤¸à¥‡")) {
      return "à¤•à¥ˆà¤¸à¥‡ à¤•à¤¾ à¤‰à¤¤à¥à¤¤à¤° à¤ªà¥à¤°à¤•à¥à¤°à¤¿à¤¯à¤¾ à¤¸à¥‡ à¤œà¥à¤¡à¤¼à¤¾ à¤¹à¥‹à¤¤à¤¾ à¤¹à¥ˆà¥¤ à¤†à¤ª à¤•à¤¿à¤¸ à¤¬à¤¾à¤°à¥‡ à¤®à¥‡à¤‚ à¤ªà¥‚à¤› à¤°à¤¹à¥‡ à¤¹à¥ˆà¤‚?";
    }

    // à¤•à¥à¤¯à¤¾
    if (text.includes("à¤•à¥à¤¯à¤¾")) {
      return "à¤†à¤ª à¤œà¥‹ à¤ªà¥‚à¤› à¤°à¤¹à¥‡ à¤¹à¥ˆà¤‚, à¤µà¤¹ à¤µà¤¿à¤·à¤¯ à¤ªà¤° à¤¨à¤¿à¤°à¥à¤­à¤° à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆà¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤¥à¥‹à¤¡à¤¼à¤¾ à¤”à¤° à¤¬à¤¤à¤¾à¤‡à¤à¥¤";
    }

    // fallback (GUARANTEED)
    return "à¤†à¤ªà¤•à¤¾ à¤ªà¥à¤°à¤¶à¥à¤¨ à¤¸à¤®à¤ à¤®à¥‡à¤‚ à¤† à¤°à¤¹à¤¾ à¤¹à¥ˆ, à¤²à¥‡à¤•à¤¿à¤¨ à¤µà¤¿à¤·à¤¯ à¤¸à¥à¤ªà¤·à¥à¤Ÿ à¤¨à¤¹à¥€à¤‚ à¤¹à¥ˆà¥¤";
  }

  /* =========================
     HELPERS (PURE)
  ========================= */
  isQuestion(text) {
    return (
      text.endsWith("?") ||
      this.includesAny(text, ["à¤•à¥à¤¯à¤¾", "à¤•à¥à¤¯à¥‹à¤‚", "à¤•à¥ˆà¤¸à¥‡", "à¤•à¤¬", "à¤•à¤¹à¤¾à¤", "à¤•à¥Œà¤¨"])
    );
  }

  includesAny(text, words) {
    return words.some(word => text.includes(word));
  }
}
