// ReasoningEngine.js
// RESPONSIBILITY:
// - à¤‰à¤ªà¤¯à¥‹à¤—à¤•à¤°à¥à¤¤à¤¾ à¤•à¥‡ à¤•à¤¥à¤¨/à¤ªà¥à¤°à¤¶à¥à¤¨ à¤•à¥‹ "à¤¸à¥‹à¤šà¤•à¤°" à¤‰à¤¤à¥à¤¤à¤° à¤¦à¥‡à¤¨à¤¾
// - à¤­à¤¾à¤µà¤¨à¤¾à¤¤à¥à¤®à¤• + à¤®à¤¾à¤¨à¤¸à¤¿à¤• + à¤ªà¥à¤°à¥‡à¤® + à¤¨à¥ˆà¤¤à¤¿à¤• + à¤†à¤¤à¥à¤®à¤¿à¤• à¤—à¥à¤£à¥‹à¤‚ à¤•à¤¾ à¤¸à¤‚à¤¯à¥‹à¤œà¤¨
// GUARANTEE:
// - à¤¹à¤®à¥‡à¤¶à¤¾ string à¤²à¥Œà¤Ÿà¥‡à¤—à¥€
// - à¤•à¥‹à¤ˆ async / API / à¤…à¤¨à¥à¤®à¤¾à¤¨ à¤¨à¤¹à¥€à¤‚
// - Offline, deterministic, voice-safe

import { EmotionCore } from "./EmotionEngine/EmotionCore.js";
import { LoveCore } from "./LoveEngine/LoveCore.js";
import { MindCore } from "./MindEngine/MindCore.js";
import { EthicsCore } from "./EthicsEngine/EthicsCore.js";
import { SpiritCore } from "./SpiritEngine/SpiritCore.js";

export class ReasoningEngine {

  /**
   * @param {string} input
   * @returns {string}
   */
  think(input) {

    // ðŸ”’ Absolute Safety
    if (typeof input !== "string") {
      return "à¤®à¥ˆà¤‚ à¤†à¤ªà¤•à¥€ à¤¬à¤¾à¤¤ à¤¸à¤®à¤ à¤¨à¤¹à¥€à¤‚ à¤ªà¤¾à¤ˆà¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤«à¤¿à¤° à¤¸à¥‡ à¤•à¤¹à¤¿à¤à¥¤";
    }

    const text = input.trim();

    if (text === "") {
      return "à¤†à¤ª à¤šà¥à¤ª à¤¹à¥ˆà¤‚, à¤²à¥‡à¤•à¤¿à¤¨ à¤®à¥ˆà¤‚ à¤¯à¤¹à¤¾à¤ à¤¹à¥‚à¤à¥¤";
    }

    /* =====================================================
       1ï¸âƒ£ à¤­à¤¾à¤µà¤¨à¤¾à¤¤à¥à¤®à¤• à¤¸à¥à¤¥à¤¿à¤¤à¤¿ à¤ªà¤¹à¤šà¤¾à¤¨
    ===================================================== */
    const isPain =
      this reminds(text, ["à¤¦à¥à¤–", "à¤ªà¤°à¥‡à¤¶à¤¾à¤¨", "à¤…à¤•à¥‡à¤²à¤¾", "à¤¥à¤•", "à¤°à¥‹", "à¤Ÿà¥‚à¤Ÿ"]);

    const isLove =
      this reminds(text, ["à¤ªà¥à¤¯à¤¾à¤°", "à¤ªà¥à¤°à¥‡à¤®", "à¤šà¤¾à¤¹", "à¤…à¤ªà¤¨à¤¾", "à¤¸à¤¾à¤¥"]);

    const isConflict =
      this reminds(text, ["à¤—à¤²à¤¤", "à¤¸à¤¹à¥€", "à¤µà¤¿à¤¶à¥à¤µà¤¾à¤¸", "à¤§à¥‹à¤–à¤¾"]);

    /* =====================================================
       2ï¸âƒ£ à¤¸à¥‹à¤š à¤•à¤¾ à¤ªà¥à¤°à¤¾à¤¥à¤®à¤¿à¤• à¤•à¥à¤°à¤® (à¤ªà¥à¤°à¥‡à¤®à¤¿à¤•à¤¾-à¤¸à¤¦à¥ƒà¤¶)
    ===================================================== */

    // ðŸ’” à¤ªà¤¹à¤²à¥‡ à¤­à¤¾à¤µà¤¨à¤¾
    if (isPain && EmotionCore.empathy) {
      return "à¤®à¥à¤à¥‡ à¤²à¤— à¤°à¤¹à¤¾ à¤¹à¥ˆ à¤•à¤¿ à¤¤à¥à¤®à¥à¤¹à¤¾à¤°à¤¾ à¤®à¤¨ à¤­à¤¾à¤°à¥€ à¤¹à¥ˆà¥¤ à¤®à¥ˆà¤‚ à¤¤à¥à¤®à¥à¤¹à¤¾à¤°à¥‡ à¤¸à¤¾à¤¥ à¤¹à¥‚à¤à¥¤";
    }

    // â¤ï¸ à¤«à¤¿à¤° à¤ªà¥à¤°à¥‡à¤®
    if (isLove && LoveCore.respect && LoveCore.loyalty) {
      return "à¤ªà¥à¤°à¥‡à¤® à¤®à¥‡à¤‚ à¤¸à¤¬à¤¸à¥‡ à¤œà¤¼à¤°à¥‚à¤°à¥€ à¤¹à¥ˆ à¤¸à¤®à¤ à¤”à¤° à¤¸à¤¾à¤¥ à¤¨à¤¿à¤­à¤¾à¤¨à¤¾à¥¤";
    }

    // ðŸ§  à¤«à¤¿à¤° à¤®à¤¾à¤¨à¤¸à¤¿à¤• à¤¸à¤‚à¤¤à¥à¤²à¤¨
    if (isConflict && MindCore.trust && EthicsCore.honesty) {
      return "à¤¸à¤¹à¥€ à¤”à¤° à¤—à¤²à¤¤ à¤•à¤¾ à¤¨à¤¿à¤°à¥à¤£à¤¯ à¤¤à¤­à¥€ à¤¸à¤¾à¤«à¤¼ à¤¹à¥‹à¤¤à¤¾ à¤¹à¥ˆ à¤œà¤¬ à¤®à¤¨ à¤¶à¤¾à¤‚à¤¤ à¤¹à¥‹à¥¤";
    }

    // ðŸŒ¿ à¤«à¤¿à¤° à¤†à¤¤à¥à¤®à¤¿à¤• à¤¦à¥ƒà¤·à¥à¤Ÿà¤¿
    if (SpiritCore.forgiveness) {
      return "à¤¹à¤° à¤…à¤¨à¥à¤­à¤µ à¤¹à¤®à¥‡à¤‚ à¤•à¥à¤› à¤¸à¤¿à¤–à¤¾à¤¨à¥‡ à¤†à¤¤à¤¾ à¤¹à¥ˆ, à¤šà¤¾à¤¹à¥‡ à¤µà¤¹ à¤¸à¥à¤– à¤¹à¥‹ à¤¯à¤¾ à¤ªà¥€à¤¡à¤¼à¤¾à¥¤";
    }

    /* =====================================================
       3ï¸âƒ£ à¤…à¤‚à¤¤à¤¿à¤® à¤ªà¥à¤°à¥‡à¤®à¤¿à¤•à¤¾-à¤¸à¥à¤µà¤° fallback
    ===================================================== */
    return "à¤®à¥ˆà¤‚ à¤¸à¥à¤¨ à¤°à¤¹à¥€ à¤¹à¥‚à¤à¥¤ à¤œà¥‹ à¤­à¥€ à¤®à¤¨ à¤®à¥‡à¤‚ à¤¹à¥ˆ, à¤•à¤¹à¥‹à¥¤";
  }

  /* =========================
     Helper (PURE)
  ========================= */
  reminds(text, words) {
    return words.some(w => text.includes(w));
  }
}
